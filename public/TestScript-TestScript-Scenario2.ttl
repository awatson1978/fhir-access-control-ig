@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<https://gitlab.mitre.org/awatson/fast-access-control/TestScript/TestScript-Scenario2> a fhir:TestScript;
  fhir:nodeRole fhir:treeRoot;
  fhir:Resource.id [ fhir:value "TestScript-Scenario2"];
  fhir:DomainResource.text [
     fhir:Narrative.status [ fhir:value "generated" ];
     fhir:Narrative.div "<div xmlns=\"http://www.w3.org/1999/xhtml\"><p><b>Generated Narrative: TestScript</b><a name=\"TestScript-Scenario2\"> </a></p><div style=\"display: inline-block; background-color: #d9e0e7; padding: 6px; margin: 4px; border: 1px solid #8da1b4; border-radius: 5px; line-height: 60%\"><p style=\"margin-bottom: 0px\">Resource TestScript \"TestScript-Scenario2\" </p></div><p><b>url</b>: <code>http://</code></p><p><b>version</b>: 0.1.0</p><p><b>name</b>: Scenario 2</p><p><b>title</b>: R4 TestScript - Patients Can Only Access Their Own Data</p><p><b>status</b>: draft</p><p><b>date</b>: 2022-06-14 11:19:30+0000</p><p><b>publisher</b>: MITRE</p><p><b>contact</b>: MITRE: <a href=\"https://www.mitre.org\">https://www.mitre.org</a></p><p><b>jurisdiction</b>: United States of America <span style=\"background: LightGoldenRodYellow; margin: 4px; border: 1px solid khaki\"> (<a href=\"http://terminology.hl7.org/4.0.0/CodeSystem-ISO3166Part1.html\">ISO 3166-1 Codes for the representation of names of countries and their subdivisions â€” Part 1: Country code</a>#US)</span></p><blockquote><p><b>fixture</b></p><p><b>autocreate</b>: true</p><p><b>autodelete</b>: true</p><p><b>resource</b>: <a href=\"PharmLoc2\">PharmLoc2: OrgA CT Location 2</a></p></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 0.1 Create hospital organization</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Organization</td><td>Hospital Organization</td><td>PUT /baseR4/Organization/J4aabjHFaXv73ZvME</td><td>json</td><td>true</td><td>put</td><td>/baseR4/Organization/J4aabjHFaXv73ZvME</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Success).</td><td>created</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 0.2 Create women's shelter organization</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Organization</td><td>Women's Shelter Organization</td><td>PUT /baseR4/Organization/lyW5mPW2nf3DHC7h6</td><td>json</td><td>true</td><td>put</td><td>/baseR4/Organization/lyW5mPW2nf3DHC7h6</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Success).</td><td>created</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 0.3  Create hospital location</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Location</td><td>Hospital Location</td><td>PUT /baseR4/Location/6kKu6iPnJtMozpaBp</td><td>json</td><td>true</td><td>put</td><td>/baseR4/Location/6kKu6iPnJtMozpaBp</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Success).</td><td>created</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 0.4 Create women's shelter location</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Location</td><td>Women's Shelter Location</td><td>PUT /baseR4/Location/qirz9TRTPfkDgBSs8</td><td>json</td><td>true</td><td>put</td><td>/baseR4/Location/qirz9TRTPfkDgBSs8</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Success).</td><td>created</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 0.5 Create social worker</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Practitioner</td><td>Social Worker</td><td>PUT /baseR4/Practitioner</td><td>json</td><td>true</td><td>put</td><td>/baseR4/Practitioner</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Success).</td><td>created</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 0.6 Create restriction on accessing women's shelters</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Restriction on accessing Women's Shelters</td><td>PUT /baseR4/Consent/cotkDnGQjpHijDsRR</td><td>json</td><td>true</td><td>put</td><td>/baseR4/Consent/cotkDnGQjpHijDsRR</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Success).</td><td>created</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 1.1.1 SocialWorker tries to anonymously access public organization data (and succeeds)</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Read (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code read = 'Read', stated as 'null')</td><td>Organization</td><td>1.1.1</td><td>GET /baseR4/Organization/J4aabjHFaXv73ZvME</td><td>json</td><td>true</td><td>get</td><td>/baseR4/Organization/J4aabjHFaXv73ZvME</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>okay</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 1.1.2 SocialWorker tries to anonymously access public location data (and succeeds)</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Read (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code read = 'Read', stated as 'null')</td><td>Location</td><td>1.1.2</td><td>GET /baseR4/Location/6kKu6iPnJtMozpaBp</td><td>json</td><td>true</td><td>get</td><td>/baseR4/Location/6kKu6iPnJtMozpaBp</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>okay</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 1.2.1 SocialWorker tries to anonymously access private organization data (and fails)</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Read (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code read = 'Read', stated as 'null')</td><td>Organization</td><td>1.2.1</td><td>GET /baseR4/Organization/lyW5mPW2nf3DHC7h6</td><td>json</td><td>true</td><td>get</td><td>/baseR4/Organization/lyW5mPW2nf3DHC7h6</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 401(Unauthorized).</td><td>forbidden</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 1.2.2 SocialWorker tries to anonymously access private location data (and fails)</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Read (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code read = 'Read', stated as 'null')</td><td>Location</td><td>1.2.2</td><td>GET /baseR4/Location/qirz9TRTPfkDgBSs8</td><td>json</td><td>true</td><td>get</td><td>/baseR4/Location/qirz9TRTPfkDgBSs8</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 401(forbidden).</td><td>forbidden</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 2.1 SocialWorker authenticates.</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Read (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code read = 'Read', stated as 'null')</td><td>2.1</td><td>GET /oauth/authorize</td><td>json</td><td>true</td><td>get</td><td>/oauth/authorize?response_type=code&amp;client_id=12345&amp;redirect_uri=https%3A%2F%2Finferno.healthit.gov%2Fsuites%2Fcustom%2Fsmart%2Fredirect&amp;scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&amp;state=b64686e6-5ebb-49c7-845a-821736c7d002&amp;aud=https%3A%2F%2Fnational-directory.meteorapp.com</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>okay</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 2.2 Token request</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Read (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code read = 'Read', stated as 'null')</td><td>2.2</td><td>GET /oauth/token</td><td>json</td><td>true</td><td>get</td><td>/oauth/token</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>okay</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 2.3.1 - SocialWorker tries to anonymously access private location data (and succeeds)</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Location</td><td>2.3.1</td><td>GET /baseR4/Location/qirz9TRTPfkDgBSs8</td><td>json</td><td>true</td><td>get</td><td>/baseR4/Location/qirz9TRTPfkDgBSs8</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: 2.3.2 - SocialWorker tries to anonymously access private organization data (and succeeds)</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Label</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Method</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>Update (Details: http://terminology.hl7.org/CodeSystem/testscript-operation-codes code update = 'Update', stated as 'null')</td><td>Organization</td><td>2.3.2</td><td>GET /baseR4/Organization/lyW5mPW2nf3DHC7h6</td><td>json</td><td>true</td><td>get</td><td>/baseR4/Organization/lyW5mPW2nf3DHC7h6</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>false</td></tr></table></blockquote></blockquote></div>"
  ];
  fhir:TestScript.url [ fhir:value "http://"];
  fhir:TestScript.version [ fhir:value "0.1.0"];
  fhir:TestScript.name [ fhir:value "Scenario 2"];
  fhir:TestScript.title [ fhir:value "R4 TestScript - Patients Can Only Access Their Own Data"];
  fhir:TestScript.status [ fhir:value "draft"];
  fhir:TestScript.date [ fhir:value "2022-06-14T23:19:30.696Z"^^xsd:dateTime];
  fhir:TestScript.publisher [ fhir:value "MITRE"];
  fhir:TestScript.contact [
     fhir:index 0;
     fhir:ContactDetail.name [ fhir:value "MITRE" ];
     fhir:ContactDetail.telecom [
       fhir:index 0;
       fhir:ContactPoint.system [ fhir:value "url" ];
       fhir:ContactPoint.value [ fhir:value "https://www.mitre.org" ]
     ]
  ];
  fhir:TestScript.jurisdiction [
     fhir:index 0;
     fhir:CodeableConcept.coding [
       fhir:index 0;
       fhir:Coding.system [ fhir:value "urn:iso:std:iso:3166" ];
       fhir:Coding.code [ fhir:value "US" ]
     ]
  ];
  fhir:TestScript.fixture [
     fhir:index 0;
     fhir:Element.id [ fhir:value "73594318-988d-5647-b3d8-1f1841578c27" ];
     fhir:TestScript.fixture.autocreate [ fhir:value "true"^^xsd:boolean ];
     fhir:TestScript.fixture.autodelete [ fhir:value "true"^^xsd:boolean ];
     fhir:TestScript.fixture.resource [
       fhir:Reference.reference [ fhir:value "PharmLoc2" ];
       fhir:Reference.display [ fhir:value "OrgA CT Location 2" ]
     ]
  ];
  fhir:TestScript.test [
     fhir:index 0;
     fhir:Element.id [ fhir:value "3823df50-2a7e-48e7-8f70-921067974a05" ];
     fhir:TestScript.test.name [ fhir:value "0.1 Create hospital organization" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Organization" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "Hospital Organization" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "PUT /baseR4/Organization/J4aabjHFaXv73ZvME" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "put" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Organization/J4aabjHFaXv73ZvME" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 201(Success)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "created" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 1;
     fhir:Element.id [ fhir:value "f390140a-edd9-4c04-8131-f50e06f8a40a" ];
     fhir:TestScript.test.name [ fhir:value "0.2 Create women's shelter organization" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Organization" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "Women's Shelter Organization" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "PUT /baseR4/Organization/lyW5mPW2nf3DHC7h6" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "put" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Organization/lyW5mPW2nf3DHC7h6" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 201(Success)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "created" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 2;
     fhir:Element.id [ fhir:value "80ca8957-a591-4a3c-835e-7018bf03660b" ];
     fhir:TestScript.test.name [ fhir:value "0.3  Create hospital location" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Location" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "Hospital Location" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "PUT /baseR4/Location/6kKu6iPnJtMozpaBp" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "put" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Location/6kKu6iPnJtMozpaBp" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 201(Success)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "created" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 3;
     fhir:Element.id [ fhir:value "ef27765c-a138-5669-b255-17bb91d30cc0" ];
     fhir:TestScript.test.name [ fhir:value "0.4 Create women's shelter location" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Location" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "Women's Shelter Location" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "PUT /baseR4/Location/qirz9TRTPfkDgBSs8" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "put" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Location/qirz9TRTPfkDgBSs8" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 201(Success)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "created" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 4;
     fhir:Element.id [ fhir:value "ed7f8206-22ad-4bce-b3d8-83980dc0af5e" ];
     fhir:TestScript.test.name [ fhir:value "0.5 Create social worker" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Practitioner" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "Social Worker" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "PUT /baseR4/Practitioner" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "put" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Practitioner" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 201(Success)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "created" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 5;
     fhir:Element.id [ fhir:value "309ca261-92bf-5063-ba69-77f29c52c671" ];
     fhir:TestScript.test.name [ fhir:value "0.6 Create restriction on accessing women's shelters" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "Restriction on accessing Women's Shelters" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "PUT /baseR4/Consent/cotkDnGQjpHijDsRR" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "put" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Consent/cotkDnGQjpHijDsRR" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 201(Success)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "created" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 6;
     fhir:Element.id [ fhir:value "ed7f8206-22ad-4bce-b3d8-83980dc0af5e" ];
     fhir:TestScript.test.name [ fhir:value "1.1.1 SocialWorker tries to anonymously access public organization data (and succeeds)" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "read" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Organization" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "1.1.1" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /baseR4/Organization/J4aabjHFaXv73ZvME" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Organization/J4aabjHFaXv73ZvME" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 200(OK)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "okay" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 7;
     fhir:Element.id [ fhir:value "ed7f8206-22ad-4bce-b3d8-83980dc0af5e" ];
     fhir:TestScript.test.name [ fhir:value "1.1.2 SocialWorker tries to anonymously access public location data (and succeeds)" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "read" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Location" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "1.1.2" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /baseR4/Location/6kKu6iPnJtMozpaBp" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Location/6kKu6iPnJtMozpaBp" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 200(OK)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "okay" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 8;
     fhir:Element.id [ fhir:value "486e9754-3a48-45c0-b43e-94e16e078d71" ];
     fhir:TestScript.test.name [ fhir:value "1.2.1 SocialWorker tries to anonymously access private organization data (and fails)" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "read" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Organization" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "1.2.1" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /baseR4/Organization/lyW5mPW2nf3DHC7h6" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Organization/lyW5mPW2nf3DHC7h6" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 401(Unauthorized)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "forbidden" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 9;
     fhir:Element.id [ fhir:value "486e9754-3a48-45c0-b43e-94e16e078d71" ];
     fhir:TestScript.test.name [ fhir:value "1.2.2 SocialWorker tries to anonymously access private location data (and fails)" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "read" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Location" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "1.2.2" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /baseR4/Location/qirz9TRTPfkDgBSs8" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Location/qirz9TRTPfkDgBSs8" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 401(forbidden)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "forbidden" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 10;
     fhir:Element.id [ fhir:value "668a7b70-e747-42d3-a100-632f1a87cd40" ];
     fhir:TestScript.test.name [ fhir:value "2.1 SocialWorker authenticates." ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "read" ]
         ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "2.1" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /oauth/authorize" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/oauth/authorize?response_type=code&client_id=12345&redirect_uri=https%3A%2F%2Finferno.healthit.gov%2Fsuites%2Fcustom%2Fsmart%2Fredirect&scope=launch%2Fpatient+openid+fhirUser+offline_access+patient%2F*.read&state=b64686e6-5ebb-49c7-845a-821736c7d002&aud=https%3A%2F%2Fnational-directory.meteorapp.com" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 200(OK)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "okay" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 11;
     fhir:Element.id [ fhir:value "0580315d-c072-46da-841e-500ad5d5f931" ];
     fhir:TestScript.test.name [ fhir:value "2.2 Token request" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "read" ]
         ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "2.2" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /oauth/token" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/oauth/token" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 200(OK)." ];
         fhir:TestScript.setup.action.assert.response [ fhir:value "okay" ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 12;
     fhir:Element.id [ fhir:value "595cab8f-6302-44f1-a930-6b02da515216" ];
     fhir:TestScript.test.name [ fhir:value "2.3.1 - SocialWorker tries to anonymously access private location data (and succeeds)" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Location" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "2.3.1" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /baseR4/Location/qirz9TRTPfkDgBSs8" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Location/qirz9TRTPfkDgBSs8" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 200(OK)." ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ], [
     fhir:index 13;
     fhir:Element.id [ fhir:value "595cab8f-6302-44f1-a930-6b02da515216" ];
     fhir:TestScript.test.name [ fhir:value "2.3.2 - SocialWorker tries to anonymously access private organization data (and succeeds)" ];
     fhir:TestScript.test.action [
       fhir:index 0;
       fhir:TestScript.test.action.operation [
         fhir:TestScript.setup.action.operation.type [
           fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/testscript-operation-codes" ];
           fhir:Coding.code [ fhir:value "update" ]
         ];
         fhir:TestScript.setup.action.operation.resource [ fhir:value "Organization" ];
         fhir:TestScript.setup.action.operation.label [ fhir:value "2.3.2" ];
         fhir:TestScript.setup.action.operation.description [ fhir:value "GET /baseR4/Organization/lyW5mPW2nf3DHC7h6" ];
         fhir:TestScript.setup.action.operation.accept [ fhir:value "json" ];
         fhir:TestScript.setup.action.operation.encodeRequestUrl [ fhir:value "true"^^xsd:boolean ];
         fhir:TestScript.setup.action.operation.method [ fhir:value "get" ];
         fhir:TestScript.setup.action.operation.url [ fhir:value "/baseR4/Organization/lyW5mPW2nf3DHC7h6" ]
       ]
     ], [
       fhir:index 1;
       fhir:TestScript.test.action.assert [
         fhir:TestScript.setup.action.assert.description [ fhir:value "Confirm that the returned HTTP status is 200(OK)." ];
         fhir:TestScript.setup.action.assert.warningOnly [ fhir:value "false"^^xsd:boolean ]
       ]
     ]
  ] .

# - ontology header ------------------------------------------------------------

<https://gitlab.mitre.org/awatson/fast-access-control/TestScript/TestScript-Scenario2.ttl> a owl:Ontology;
  owl:imports fhir:fhir.ttl .

# -------------------------------------------------------------------------------------

